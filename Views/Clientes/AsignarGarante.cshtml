<!-- Views/Clientes/AsignarGarante.cshtml -->
@model Javo2.ViewModels.Operaciones.Clientes.GaranteViewModel
@{
    ViewData["Title"] = "Asignar Garante";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section class="container-fluid py-3">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h2 mb-0">Asignar Garante para @Model.NombreCliente</h1>
        <a asp-action="Details" asp-route-id="@Model.ClienteID" class="btn btn-outline-light">
            <i class="bi bi-arrow-left me-1"></i> Volver al cliente
        </a>
    </div>

    <div class="card shadow-sm bg-dark text-light">
        <div class="card-body">
            <form asp-action="AsignarGarante" method="post">
                @Html.AntiForgeryToken()
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                
                <input type="hidden" asp-for="ClienteID" />
                <input type="hidden" asp-for="NombreCliente" />

                <fieldset class="mb-4">
                    <legend class="text-light">Datos Personales</legend>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label asp-for="Nombre" class="form-label">Nombre</label>
                            <input asp-for="Nombre" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="Nombre" class="text-danger"></span>
                        </div>
                        <div class="col-md-4">
                            <label asp-for="Apellido" class="form-label">Apellido</label>
                            <input asp-for="Apellido" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="Apellido" class="text-danger"></span>
                        </div>
                        <div class="col-md-4">
                            <label asp-for="DNI" class="form-label">DNI</label>
                            <input asp-for="DNI" type="number" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="DNI" class="text-danger"></span>
                        </div>
                        <div class="col-md-4">
                            <label asp-for="Email" class="form-label">Email</label>
                            <input asp-for="Email" type="email" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>
                        <div class="col-md-4">
                            <label asp-for="Telefono" class="form-label">Teléfono</label>
                            <input asp-for="Telefono" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="Telefono" class="text-danger"></span>
                        </div>
                        <div class="col-md-4">
                            <label asp-for="Celular" class="form-label">Celular</label>
                            <input asp-for="Celular" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="Celular" class="text-danger"></span>
                        </div>
                    </div>
                </fieldset>
                
                <fieldset class="mb-4">
                    <legend class="text-light">Domicilio</legend>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label asp-for="Calle" class="form-label">Calle</label>
                            <input asp-for="Calle" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="Calle" class="text-danger"></span>
                        </div>
                        <div class="col-md-2">
                            <label asp-for="NumeroCalle" class="form-label">Número</label>
                            <input asp-for="NumeroCalle" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="NumeroCalle" class="text-danger"></span>
                        </div>
                        <div class="col-md-2">
                            <label asp-for="NumeroPiso" class="form-label">Piso</label>
                            <input asp-for="NumeroPiso" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="NumeroPiso" class="text-danger"></span>
                        </div>
                        <div class="col-md-2">
                            <label asp-for="Dpto" class="form-label">Dpto</label>
                            <input asp-for="Dpto" class="form-control bg-secondary text-light" />
                            <span asp-validation-for="Dpto" class="text-danger"></span>
                        </div>
                        <div class="col-md-4">
                            <label asp-for="ProvinciaID" class="form-label">Provincia</label>
                            <select asp-for="ProvinciaID" asp-items="Model.Provincias" class="form-select bg-secondary text-light">
                                <option value="">-- Seleccione --</option>
                            </select>
                            <span asp-validation-for="ProvinciaID" class="text-danger"></span>
                        </div>
                       

                        <div class="col-md-4">
    <label asp-for="CiudadID" class="form-label">Ciudad</label>
    <select asp-for="CiudadID" asp-items="Model.Ciudades" class="form-select bg-secondary text-light">
        <option value="">-- Seleccione --</option>
    </select>
    <span asp-validation-for="CiudadID" class="text-danger"></span>
</div>
<div class="col-md-4">
    <label asp-for="Localidad" class="form-label">Localidad</label>
    <input asp-for="Localidad" class="form-control bg-secondary text-light" />
    <span asp-validation-for="Localidad" class="text-danger"></span>
</div>
<div class="col-md-4">
    <label asp-for="CodigoPostal" class="form-label">Código Postal</label>
    <input asp-for="CodigoPostal" class="form-control bg-secondary text-light" />
    <span asp-validation-for="CodigoPostal" class="text-danger"></span>
</div>
</div>
</fieldset>
<fieldset class="mb-4">
    <legend class="text-light">Información Laboral y Relación</legend>
    <div class="row g-3">
        <div class="col-md-6">
            <label asp-for="LugarTrabajo" class="form-label">Lugar de Trabajo</label>
            <input asp-for="LugarTrabajo" class="form-control bg-secondary text-light" />
            <span asp-validation-for="LugarTrabajo" class="text-danger"></span>
        </div>
        <div class="col-md-6">
            <label asp-for="IngresosMensuales" class="form-label">Ingresos Mensuales</label>
            <input asp-for="IngresosMensuales" type="number" step="0.01" class="form-control bg-secondary text-light" />
            <span asp-validation-for="IngresosMensuales" class="text-danger"></span>
        </div>
        <div class="col-md-12">
            <label asp-for="RelacionCliente" class="form-label">Relación con el Cliente</label>
            <select asp-for="RelacionCliente" class="form-select bg-secondary text-light">
                <option value="">-- Seleccione --</option>
                <option value="Familiar">Familiar</option>
                <option value="Amistad">Amistad</option>
                <option value="Laboral">Laboral</option>
                <option value="Otro">Otro</option>
            </select>
            <span asp-validation-for="RelacionCliente" class="text-danger"></span>
        </div>
    </div>
</fieldset>
<div class="d-flex justify-content-end mt-4">
    <a asp-action="Details" asp-route-id="@Model.ClienteID" class="btn btn-outline-secondary me-2">Cancelar</a>
    <button type="submit" class="btn btn-primary">Asignar Garante</button>
</div>
</form>
</div>
</div>
</section>
@section Scripts {
@await Html.PartialAsync("_ValidationScriptsPartial")
<script>
$(function () {
// Cargar ciudades al cambiar provincia
$('#ProvinciaID').change(function () {
var provinciaID = $(this).val();
if (provinciaID) {
$.ajax({
url: '@Url.Action("GetCiudades", "Clientes")',
type: 'GET',
data: { provinciaID: provinciaID },
success: function (ciudades) {
var ciudadSelect = $('#CiudadID');
ciudadSelect.empty();
ciudadSelect.append('<option value="">-- Seleccione --</option>');
$.each(ciudades, function (i, ciudad) {
ciudadSelect.append($('<option></option>').val(ciudad.value).text(ciudad.text));
});
},
error: function () {
alert('Error al cargar ciudades');
}
});
} else {
$('#CiudadID').empty().append('<option value="">-- Seleccione --</option>');
}
});
});
</script>
}