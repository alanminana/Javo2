@using System.Security.Claims

@{
    bool tienePermisoUsuarios = User.HasClaim(c => c.Type == "Permission" && c.Value == "usuarios.ver");
    bool tienePermisoRoles = User.HasClaim(c => c.Type == "Permission" && c.Value == "roles.ver");
    bool tienePermisoPermisos = User.HasClaim(c => c.Type == "Permission" && c.Value == "permisos.ver");
    bool tienePermisoConfiguracion = User.HasClaim(c => c.Type == "Permission" && c.Value == "configuracion.ver");

    string controller = ViewContext.RouteData.Values["controller"]?.ToString();
}

<div class="card shadow-sm mb-4">
    <div class="card-header p-0">
        <ul class="nav nav-tabs nav-fill card-header-tabs">
            <li class="nav-item">
                <a class="nav-link @(controller == "SecurityDashboard" ? "active" : "")" asp-controller="SecurityDashboard" asp-action="Index">
                    <i class="bi bi-speedometer2 me-1"></i>Dashboard
                </a>
            </li>
            @if (tienePermisoUsuarios)
            {
                <li class="nav-item">
                    <a class="nav-link @(controller == "Usuarios" ? "active" : "")" asp-controller="Usuarios" asp-action="Index">
                        <i class="bi bi-people-fill me-1"></i>Usuarios
                    </a>
                </li>
            }
            @if (tienePermisoRoles)
            {
                <li class="nav-item">
                    <a class="nav-link @(controller == "Roles" ? "active" : "")" asp-controller="Roles" asp-action="Index">
                        <i class="bi bi-person-badge-fill me-1"></i>Roles
                    </a>
                </li>
            }
            @if (tienePermisoPermisos)
            {
                <li class="nav-item">
                    <a class="nav-link @(controller == "Permisos" ? "active" : "")" asp-controller="Permisos" asp-action="Index">
                        <i class="bi bi-key-fill me-1"></i>Permisos
                    </a>
                </li>
            }
            @if (tienePermisoConfiguracion)
            {
                <li class="nav-item">
                    <a class="nav-link @(controller == "Configuracion" && ViewContext.RouteData.Values["action"]?.ToString() == "Seguridad" ? "active" : "")" asp-controller="Configuracion" asp-action="Seguridad">
                        <i class="bi bi-gear-fill me-1"></i>Configuración
                    </a>
                </li>
            }
            <li class="nav-item">
                <a class="nav-link @(controller == "Auth" && ViewContext.RouteData.Values["action"]?.ToString() == "CambiarContraseña" ? "active" : "")" asp-controller="Auth" asp-action="CambiarContraseña">
                    <i class="bi bi-lock-fill me-1"></i>Cambiar Contraseña
                </a>
            </li>
        </ul>
    </div>
</div>